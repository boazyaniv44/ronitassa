---
const reviews = [
  {
    author: "Dana",
    text: "הכל טרי ונקי. האוכל טעים. הבשר נטחן במקום והעוף באיכות גבוהה. מקום נהדר.",
    rating: 5,
    date: "לפני חודשיים"
  },
  {
    author: "Boaz Yaniv",
    text: "מקום נהדר, בשר מצוין, מחירים הוגנים, הבעלים אנשים מקסימים, מומלץ בחום.",
    rating: 5,
    date: "לפני 3 חודשים"
  },
  {
    author: "Timor Shater",
    text: "נקי ומסודר, הבעלים של המקום מרגיש כמו אדם טוב. הבשר טוב מאוד וטרי.",
    rating: 5,
    date: "לפני 4 חודשים"
  },
  {
    author: "יגאל יפת",
    text: "אטליז רוני נקי ומסודר, עובדים עם כפפות, שירות אדיב.",
    rating: 5,
    date: "לפני שנתיים"
  },
  {
    author: "Yuval Hallelui",
    text: "מקום נהדר.",
    rating: 5,
    date: "לפני 3 שנים"
  }
];
---

<section class="py-16 bg-off-white overflow-hidden" dir="rtl">
  <div class="container mx-auto px-4">
    <div class="text-center mb-12">
      <h2 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">לקוחות ממליצים</h2>
      <div class="w-24 h-1 bg-primary mx-auto rounded-full mb-4"></div>
      <p class="text-xl text-gray-600">מדורג 5/5 בגוגל ⭐⭐⭐⭐⭐</p>
    </div>

    <div class="relative max-w-7xl mx-auto">
      <!-- Carousel Container -->
      <div 
        id="reviews-track"
        class="flex gap-6 overflow-x-auto pb-8 snap-x snap-mandatory scrollbar-hide -mx-4 px-4 md:mx-0 md:px-0"
        style="scroll-behavior: smooth;"
      >
        {reviews.map((review) => (
          <div class="min-w-[85vw] md:min-w-[0] md:w-[350px] flex-none snap-center">
            <div class="bg-white p-8 rounded-2xl shadow-lg h-full border border-gray-100 hover:shadow-xl transition-shadow flex flex-col items-center text-center">
              <!-- Google Icon/Avatar Placeholder -->
              <div class="w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center text-primary mb-4 text-xl font-bold">
                {review.author.charAt(0)}
              </div>
              
              <!-- Stars -->
              <div class="flex text-yellow-400 mb-4 gap-1">
                {'★'.repeat(review.rating)}
              </div>

              <!-- Text -->
              <blockquote class="text-lg text-gray-700 mb-6 flex-grow leading-relaxed">
                "{review.text}"
              </blockquote>

              <!-- Author Info -->
              <div class="mt-auto border-t border-gray-100 pt-4 w-full">
                <cite class="not-italic font-bold text-gray-900 block text-lg">{review.author}</cite>
                <!-- <span class="text-sm text-gray-500">{review.date}</span> -->
              </div>
            </div>
          </div>
        ))}
      </div>

      <!-- Navigation Indicators -->
      <div class="flex justify-center gap-2 mt-4">
        {reviews.map((_, idx) => (
          <button 
            class="nav-dot w-3 h-3 rounded-full bg-gray-300 transition-colors hover:bg-primary data-[active=true]:bg-primary"
            aria-label={"Go to slide " + (idx + 1)}
          ></button>
        ))}
      </div>
    </div>
  </div>
</section>

<style>
  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }
</style>

<script>
  const track = document.getElementById('reviews-track');
  
  if (track) {
    let scrollInterval;
    const scrollAmount = 1; // Speed
    const delay = 3000; // Pause time
    
    // Auto scroll functionality could be added here if desired, 
    // but typically CSS snap is enough for good UX. 
    // Let's implement a simple auto-advance.

    let index = 0;
    const cards = track.children;
    const totalCards = cards.length;

    const autoSlide = () => {
        if (!track.matches(':hover')) { // Pause on hover
            index = (index + 1) % totalCards;
            const cardWidth = cards[0].offsetWidth + 24; // 24 is gap
            // RTL scroll calculation: In RTL, scrolling "right" usually means negative X or tracking normally depending on browser.
            // Actually, safe bet is using scrollLeft. In RTL, scrollLeft can be negative or positive depending on implementation.
            // Let's just use scrollIntoView for simplicity.
            cards[index].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        }
    };


    // Navigation dots
    const dots = document.querySelectorAll('.nav-dot');
    dots.forEach((dot, dotIndex) => {
      dot.addEventListener('click', () => {
        // const i = parseInt(dot.getAttribute('data-index')); // Removed attribute dependence
        const cardWidth = cards[0].offsetWidth + 24;
        
        cards[dotIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest', inline: 'center' });
        
        index = dotIndex; // update current index
      });
    });

    // setInterval(autoSlide, 5000);
  }
</script>
